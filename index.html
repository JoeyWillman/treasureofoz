<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <title>Oz County Treasures</title>
  <meta name="description" content="Explore Ozaukee County's parks, trails, history, and hidden gems on a retro-styled interactive map." />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Work+Sans:wght@300;400;600&display=swap" rel="stylesheet">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- MarkerCluster CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">

  <!-- Site styles -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
   <!-- Header -->
  <header id="site-header">
  <div class="brand">
    <a href="index.html" class="brand-logo" aria-label="Go to map">
      <img src="data/photos/logo.png" alt="" class="logo" loading="lazy">
    </a>
    <div class="brand-text">
      <h1 class="site-title">Treasures of Oz</h1>
      <p class="tag">Celebrating the Natural Gems of Ozaukee County</p>
    </div>
  </div>
  <nav class="nav-links">
    <a href="index.html" class="nav-item">Home</a>
    <a href="about.html" class="nav-item">About</a>
    <a href="links.html" class="nav-item">Links</a>
  </nav>
</header>


  <!-- Mobile-only filters (hidden on desktop) -->
  <div id="filters-mobile" class="filters-mobile" role="region" aria-label="Filters">
    <div class="filters-inner">
      <input id="mSearch" type="search" placeholder="Search places…" aria-label="Search" />
      <select id="mFilterType" aria-label="Filter by type">
        <option value="">Type: All</option>
        <option value="naturepreserve">Nature Preserve</option>
        <option value="parks">Park</option>
        <option value="wpa">WPA</option>
        <option value="other">Other</option>
      </select>
      <select id="mFilterLocation" aria-label="Filter by location (town/city)">
        <option value="">Location: All</option>
      </select>
      <select id="mFilterActivity" aria-label="Filter by activity">
        <option value="">Activity: All</option>
      </select>
    </div>
  </div>

  <main id="layout">
    <aside id="sidebar" aria-label="Treasure list and filters">
      <div class="panel">
        <div class="search-row">
          <input id="search" type="search" placeholder="Search places…" aria-label="Search" />
          <select id="filterType" aria-label="Filter by type">
            <option value="">Type: All</option>
            <option value="naturepreserve">Nature Preserve</option>
            <option value="parks">Park</option>
            <option value="wpa">WPA</option>
            <option value="other">Other</option>
          </select>
          <select id="filterLocation" aria-label="Filter by location (town/city)">
            <option value="">Location: All</option>
          </select>
          <select id="filterActivity" aria-label="Filter by activity">
            <option value="">Activity: All</option>
          </select>
        </div>
        <div class="chips" id="chipBar"></div>
      </div>

      <ul id="list" class="list" aria-live="polite"></ul>
    </aside>

    <section id="map-wrap">
      <div id="map" role="region" aria-label="Map of Ozaukee County"></div>

<!-- Small, accessible map info button -->
<button id="mapInfoBtn" class="map-info" type="button" aria-haspopup="dialog" aria-controls="info-modal" aria-label="How to use this map">?</button>

<!-- Info modal -->
<div id="info-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="infoTitle" aria-hidden="true">
  <div class="modal-backdrop" data-close="true"></div>
  <div class="modal-card" role="document">
    <button class="modal-close" type="button" aria-label="Close">✕</button>
    <h2 id="infoTitle">How to Use the Map</h2>
    <div class="modal-body">
      <section class="guide">
        <ul class="guide-list">
          <li>Use the search bar and filters (Type, Location, Activity) to narrow results.</li>
          <li>Click a list item or a map marker to see details; use “Details” for photos & links.</li>
          <li>The Interurban Trail appears as a dashed green line.</li>
        </ul>
      </section>

      <section class="legend-section">
        <!-- We inject a cloned copy of the floating legend here -->
        <div id="legendEmbed"></div>
      </section>
    </div>
  </div>
</div>


   <div id="legend" class="legend" aria-hidden="false" aria-label="Map legend">
  <div class="legend-title">Legend</div>
  <ul class="legend-list" role="list">
    <li class="legend-row" role="listitem">
      <img src="data/icons/naturepreserve.png" alt="" loading="lazy"><span>Nature Preserve</span>
    </li>
    <li class="legend-row" role="listitem">
      <img src="data/icons/parks.png" alt="" loading="lazy"><span>Park</span>
    </li>
    <li class="legend-row" role="listitem">
      <img src="data/icons/wpa.png" alt="" loading="lazy"><span>WPA</span>
    </li>
    <li class="legend-row" role="listitem">
      <img src="data/icons/other.png" alt="" loading="lazy"><span>Other</span>
    </li>
    <li class="legend-row" role="listitem">
      <span class="legend-line"></span><span>Interurban Trail</span>
    </li>
  </ul>
</div>


      <!-- Detail Drawer -->
      <div id="detail-drawer" class="drawer" aria-hidden="true">
        <button class="drawer-close" type="button" aria-label="Close details">✕</button>
        <div class="drawer-body" id="drawerBody"></div>
      </div>
    </section>
  </main>

  <footer id="site-footer">
    <p>Basemap © <a href="https://carto.com/" target="_blank" rel="noopener">CARTO</a> · © OpenStreetMap contributors · Built by Joey Willman</p>
  </footer>

  <!-- Consolidated layout measurements (replaces two near-duplicates) -->
  <script>
    (function () {
      function setLayoutVars() {
        const hdr = document.getElementById('site-header');
        const ftr = document.getElementById('site-footer');
        const mob = document.getElementById('filters-mobile');
        if (hdr) document.documentElement.style.setProperty('--hdr', Math.round(hdr.getBoundingClientRect().height) + 'px');
        if (ftr) document.documentElement.style.setProperty('--ftr', Math.round(ftr.getBoundingClientRect().height) + 'px');
        if (mob) document.documentElement.style.setProperty('--mobf', Math.round(mob.getBoundingClientRect().height) + 'px');
      }
      if (document.fonts?.ready) document.fonts.ready.then(setLayoutVars);
      window.addEventListener('load', setLayoutVars, { passive: true });
      window.addEventListener('resize', setLayoutVars, { passive: true });
      window.addEventListener('orientationchange', setLayoutVars, { passive: true });
    })();
  </script>

  <!-- Vendor libraries (deferred so the page paints fast) -->
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script defer src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script defer src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- App script (single include) -->
  <script defer src="main.js"></script>
</body>
</html>
