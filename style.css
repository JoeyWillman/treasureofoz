/* =========================
   Retro Parks & Rec theme
   ========================= */
:root{
  /* Palette */
  --ink:#17211d;
  --bg:#f6f1e4;
  --accent:#2f7c31;
  --accent-2:#f0c23b;
  --accent-3:#c36c3c;
  --line:#c9bda4;

  /* Layout tokens (tweak if header/footer change) */
  --hdr: 88px;   /* desktop header height (logo + padding) */
  --ftr: 48px;   /* footer height */
  --mobf: 64px;  /* default mobile filter bar height fallback */
}

*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0;
  background:var(--bg);
  color:var(--ink);
  font-family:"Work Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* Strong, consistent focus ring */
:where(a, button, [role="button"], input, select).focus-visible,
:where(.nav-item, .btn, .chip).focus-visible {
  outline: 3px solid #3b7fca;
  outline-offset: 2px;
  border-radius: 8px;
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .trail-line { animation: none; filter: none; }
  #sidebar { transition: none; }
}

/* =========================
   Header & Nav
   ========================= */
#site-header{
  display:flex; align-items:center; justify-content:space-between;
  padding:.6rem 1rem;
  border-bottom:2px solid var(--line);
  background:linear-gradient(180deg,#fff8ea, #f6f1e4);
  position:sticky; top:0; z-index:40;
  gap:1rem; /* allow space between brand and nav */
}

/* Brand: keep text to the right of the logo (not underneath) */
#site-header .brand{
  display:flex; align-items:center; gap:.75rem;
  flex-wrap:nowrap;    /* prevent title from wrapping under the logo */
  min-width:0;         /* allow truncation instead of wrapping */
  flex:1 1 auto;       /* let brand claim space; nav hugs right */
}

/* Optional logo-only link wrapper (if used in HTML) */
.brand-logo{ display:inline-block; line-height:0; }

/* Title + tagline: not links, sit beside logo, allow truncation */
.brand-text{ display:flex; flex-direction:column; min-width:0 }
#site-header .brand h1,
.site-title{
  font-family:"Archivo Black", system-ui;
  font-size:1.35rem; margin:.1rem 0 0; color:var(--ink);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  text-decoration:none; /* avoid underlines if inherited */
}
#site-header .tag{
  margin:.15rem 0 0; font-weight:600; letter-spacing:.02em; color:#3b463f;
  text-decoration:none;
}

.badge{ display:inline-block; font-weight:800; letter-spacing:.08em; background:var(--accent); color:#fff; padding:.15rem .45rem; border-radius:.35rem; margin-right:.5rem; box-shadow:0 2px 0 rgba(0,0,0,.12) }

.logo{
  width:70px; height:70px; border-radius:50%;
  border:2px solid var(--accent); background:#fff; object-fit:cover;
  box-shadow:0 2px 4px rgba(0,0,0,.15);
  transition:transform .2s ease, box-shadow .2s ease;
}
.logo:hover{ transform:scale(1.06); box-shadow:0 3px 6px rgba(0,0,0,.25) }

/* Nav: a bit more "parks & rec" button polish */
.nav-links{ display:flex; align-items:center; gap:.6rem; flex:0 0 auto }
.nav-item{
  text-decoration:none; color:var(--ink); font-weight:800;
  border:2px solid var(--ink); border-radius:.6rem;
  padding:.4rem .8rem;
  background:linear-gradient(180deg,#ffffff,#fff6dd);
  box-shadow:0 2px 0 rgba(0,0,0,.15);
  transition:transform .08s ease, box-shadow .08s ease, background .2s ease, color .2s ease;
}
.nav-item:hover{
  background:linear-gradient(180deg,#f4ffe9,#e3f9d9);
  color:#0f1a16;
}
.nav-item:active{ transform:translateY(1px); box-shadow:0 1px 0 rgba(0,0,0,.15) }
.nav-item.active{
  background:linear-gradient(180deg, var(--accent), #226823);
  color:#fff;
  border-color:#0f1a16;
  box-shadow:0 2px 0 rgba(0,0,0,.2);
}

/* Buttons & chips */
.btn{
  display:inline-flex; align-items:center; gap:.35rem; padding:.45rem .6rem;
  border:2px solid var(--ink); background:#fff; border-radius:.5rem;
  font-weight:700; cursor:pointer; text-decoration:none; color:inherit;
  min-height:40px; /* touch-friendly */
}
.btn.small{ padding:.3rem .5rem; font-size:.9rem; min-height:32px }
.btn:hover{ background:#fff3d4 }
.btn:active{ transform:translateY(1px); box-shadow:none }

.chips{ display:flex; flex-wrap:wrap; gap:.35rem; margin-top:.6rem }
.chip{
  padding:.2rem .5rem; border:1.5px dashed var(--accent); border-radius:999px;
  font-size:.85rem; background:#fff; cursor:pointer; min-height:40px;
}
.chip.muted{ opacity:.7 }
.chip:active{ transform:translateY(1px); box-shadow:none }

/* =========================
   Main Layout (Header-fixed)
   ========================= */
#layout{
  display:grid;
  grid-template-columns:360px 1fr;
  height:calc(100dvh - var(--hdr)); /* keep header visible */
  min-height:420px;
}

/* Sidebar: panel fixed, list scrolls */
#sidebar{
  border-right:2px solid var(--line);
  background:#fff9ee;
  overflow:hidden;
  display:flex; flex-direction:column;
}
.panel{ padding:.75rem; border-bottom:2px solid var(--line); flex:0 0 auto }
.list{ list-style:none; margin:0; padding:0; flex:1 1 auto; overflow:auto }

/* Map column */
#map-wrap{ position:relative; min-height:0 }
#map{ position:absolute; inset:0; min-height:0 }

/* =========================
   Map Info Modal
   ========================= */
.modal {
  position: fixed;
  inset: 0;
  z-index: 1200;
  display: none;
}
.modal[aria-hidden="false"] { display: block; }

.modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.35);
  backdrop-filter: blur(1px);
}

.modal-card {
  position: relative;
  max-width: 560px;
  margin: 8vh auto;
  background: #fff;
  border: 2px solid var(--ink);
  border-radius: 12px;
  box-shadow: 0 12px 36px rgba(0,0,0,.25);
  padding: 1rem 1rem 1.1rem;
}

.modal-close {
  position: absolute;
  top: .5rem; right: .5rem;
  border: 2px solid var(--ink);
  background: #fff;
  border-radius: 8px;
  padding: .25rem .5rem;
  cursor: pointer;
}

.modal-body {
  max-height: 70vh;
  overflow: auto;
}

/* Reuse legend look inside modal without floating styles */
#legendEmbed .legend {
  position: static;
  border: none;
  padding: 0;
  box-shadow: none;
  border-radius: 0;
}
#legendEmbed .legend-list { margin-top: .25rem; }

/* Mobile comfort */
@media (max-width: 760px){
  .modal-card {
    margin: 10vh 12px;
    max-width: none;
  }
}

/* ========== Map Info Control (round "?" button) ========== */
.map-info-ctl { margin: 6px 6px 0 0; } /* small offset from edges */

.map-info-btn{
  width: 40px; height: 40px;
  border-radius: 50%;
  display: grid; place-items: center;
  border: 2px solid var(--ink);
  background: var(--accent);
  color: #fff;
  box-shadow: 0 2px 6px rgba(0,0,0,.18);
  cursor: pointer;
  transition: transform .06s ease, box-shadow .12s ease, filter .2s ease;
}
.map-info-btn:hover{ filter: brightness(1.06); box-shadow: 0 3px 8px rgba(0,0,0,.22); }
.map-info-btn:active{ transform: translateY(1px); box-shadow: 0 2px 6px rgba(0,0,0,.18); }
.map-info-btn svg{ display:block; }

@media (prefers-reduced-motion: reduce){
  .map-info-btn { transition: none; }
}

/* Keep the control above map tiles/overlays */
.leaflet-control.map-info-ctl { z-index: 1200; }

.map-info-btn{
  background: linear-gradient(180deg,#ffffff,#fff6dd);
  color: var(--ink);
  border: 2px solid var(--ink);
}

/* =========================
   Filters / Search
   ========================= */
.search-row{ display:flex; flex-wrap:wrap; gap:.5rem }
#search{
  flex:1 1 180px; min-width:160px;
  padding:.5rem .6rem; border:2px solid var(--ink); border-radius:.4rem;
  font-size:1rem; line-height:1.2;
}
#filterType, #filterLocation, #filterActivity{
  flex:1 1 140px; min-width:130px; max-width:180px;
  padding:.5rem .6rem; border:2px solid var(--ink); border-radius:.4rem; background:#fff;
  font-size:1rem; line-height:1.2;
}
::placeholder { color: rgba(23,33,29,.65); }

/* =========================
   List items
   ========================= */
.card {
  display: flex;
  gap: .6rem;
  align-items: flex-start;
  padding: .7rem .75rem;
  border-bottom: 1px solid var(--line);
  cursor: pointer;
}
.card:hover { background: #fff3d4; }

#sidebar .card img {
  width: 28px;
  height: 28px;
  display: block;
  object-fit: contain;
  background: var(--bg);
  border: 2px solid var(--accent);
  border-radius: 50%;
  padding: 4px;
  box-sizing: content-box;
}

.card .meta {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
}

.card .title {
  font-weight: 700;
}

.card .sub {
  font-size: .86rem;
  opacity: .75;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--ink);
}

/* --- Activity chips cleanup --- */
.card .acts {
  display: flex;
  align-items: center;
  gap: .35rem;
  margin-top: .25rem;
  flex-wrap: nowrap;         /* keep them on one line */
  overflow: hidden;          /* hide overflow if too many */
}

.card .acts .chip {
  display: inline-flex;
  align-items: center;
  white-space: nowrap;
  padding: .18rem .5rem;
  border: 1.5px solid var(--line);
  border-radius: 999px;
  background: #fff;
  font-size: .78rem;
  line-height: 1;
  color: var(--ink);
  font-weight: 600;
}

.card .acts .more {
  border: 1.5px solid var(--ink);
  background: #f5f0df;
  font-weight: 700;
  color: var(--ink);
}


/* =========================
   Drawer (Details)
   ========================= */
.drawer{
  position:absolute; right:12px; bottom:12px; top:12px; width:min(460px, 94vw);
  background:#fff; border:2px solid var(--ink); border-radius:12px; box-shadow:0 12px 36px rgba(0,0,0,.2);
  transform:translateY(12px) scale(.98); opacity:0; pointer-events:none; transition:.18s ease;
  display:flex; flex-direction:column; z-index:900; /* above legend & controls */
}
.drawer[aria-hidden="false"]{ transform:none; opacity:1; pointer-events:auto }
.drawer-close{ align-self:flex-end; margin:.6rem; border:2px solid var(--ink); background:#fff; border-radius:8px; padding:.25rem .5rem; cursor:pointer }
.drawer-body{ padding:1rem; overflow:auto }
.drawer-body h2{ font-family:"Archivo Black", system-ui; margin:.2rem 0 .6rem }
.drawer-body p{ line-height:1.6; margin:0 0 1em }
.drawer-body img{ max-width:100%; height:auto; border-radius:8px }
.drawer-body .meta-row{ display:flex; gap:.5rem; flex-wrap:wrap; margin:.5rem 0 .75rem }
.drawer-body .btn{ margin-right:.35rem }
.chip-row{ margin:.25rem 0 .5rem }

/* =========================
   Legend
   ========================= */
.legend{
  position:absolute; bottom:12px; left:12px;
  background:#fff;
  border:2px solid var(--ink);
  border-radius:12px;
  padding:.6rem .7rem;
  box-shadow:0 4px 0 rgba(0,0,0,.12);
  z-index:700; pointer-events:auto;
  max-width: 240px;  /* keeps it tidy */
}

.legend-title{
  font-family:"Archivo Black", system-ui;
  font-size:1rem;
  line-height:1.1;
  margin:0 0 .45rem;
  color:var(--ink);
}

/* remove bullets and lay items out with consistent gaps */
.legend-list{
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:.2rem;
}

/* each row is a small pill with better hit area */
.legend-row{
  display:flex;
  align-items:center;
  gap:.55rem;
  padding:.22rem .35rem;
  border-radius:8px;
}
.legend-row:hover,
.legend-row:focus-within{ background:#fff3d4 }

.legend-row img{
  width:20px; height:20px; display:block;
}

.legend-line{
  display:inline-block; width:18px; height:3px;
  background:#2f7c31; border-radius:2px;
}

/* Hide the floating map legend on mobile (we’ll show it in the info modal) */
@media (max-width: 760px){
  #legend { display:none; } /* hide only the floating legend */
}


/* =========================
   Footer
   ========================= */
#site-footer{ padding:.6rem 1rem; border-top:2px solid var(--line); font-size:.9rem }
#site-footer a{ color:inherit }

/* Footer for static pages (About/Links) */
.site-foot{
  padding: .8rem 1rem;
  border-top:2px solid var(--line);
  font-size:.95rem;
  text-align:center;
  background:#fff9ee;
}
.site-foot a{ color:inherit; }

/* =========================
   Leaflet tweaks
   ========================= */
.leaflet-control-zoom a{ border:2px solid var(--ink)!important; background:#fff!important; box-shadow:none!important }
.leaflet-bar a:hover{ background:#fff3d4!important }
.marker-cluster-small, .marker-cluster-medium, .marker-cluster-large{ background:#fff!important; box-shadow:0 0 0 2px var(--ink) inset }
.marker-cluster div{ background:var(--accent)!important; color:#fff; font-weight:800 }
.popup p{ margin:0 0 1.05em; line-height:1.55 }

/* Affect ONLY map tiles (never sidebar/legend images) */
.leaflet-pane .leaflet-tile{
  max-width:none!important; width:256px!important; height:256px!important;
  display:block!important; padding:0!important; margin:0!important; border:0!important; box-sizing:content-box!important;
}
.leaflet-tile, .leaflet-marker-icon, .leaflet-marker-shadow{ max-width:none!important }
.leaflet-container, .leaflet-pane, .leaflet-tile-pane, .leaflet-overlay-pane{ transform:translateZ(0) }

/* Custom treasure icons wrapper (for consistency if used elsewhere) */
.treasure-icon{
  background-color:var(--bg);
  border:2px solid var(--accent);
  border-radius:50%;
  padding:4px;
  box-sizing:content-box;
}

/* Optional shared badge sizing for icon badges elsewhere */
.badge--icon {
  width: 48px; height: 48px; border-radius: 50%;
  background: #fff; border: 2px solid var(--accent);
  display: grid; place-items: center; padding: 6px;
}
.badge--icon > img { width: 100%; height: 100%; object-fit: contain; }

/* Map marker badge (DivIcon) */
.treasure-divicon { background: transparent; border: 0; }
.treasure-pin{
  width: 36px; height: 36px;
  border: 2px solid var(--accent);
  background: #fff;
  border-radius: 50%;
  display: grid; place-items: center;
  box-shadow: 0 1px 2px rgba(0,0,0,.15);
}
.treasure-pin img{
  width: 20px; height: 20px;         /* smaller glyph so it never kisses the ring */
  display: block; object-fit: contain;
}


/* =========================
   Interurban Trail styling
   ========================= */
.trail-line{
  stroke-dasharray:8 6;
  filter: drop-shadow(0 0 4px rgba(47,124,49,.5)) drop-shadow(0 0 6px rgba(47,124,49,.3));
  animation:dashmove 12s linear infinite;
}
@keyframes dashmove{ to{ stroke-dashoffset:-200 } }
.leaflet-pane#trailPane path:hover{ stroke-width:6!important; filter:drop-shadow(0 0 8px rgba(47,124,49,.7)) }

/* =========================
   Static pages (About / Links)
   ========================= */

/* Page container */
#content{
  padding: 2rem 1.25rem 3rem;
  max-width: 960px;
  margin: 0 auto;
}

/* Headings */
#content h1{
  font-family:"Archivo Black", system-ui;
  font-size: 1.85rem;
  line-height: 1.2;
  margin: 0 0 .65rem;
  color: var(--ink);
}
#content h2{
  font-family:"Archivo Black", system-ui;
  font-size: 1.4rem;
  line-height: 1.25;
  margin: 0 0 .5rem;
  color: var(--accent);
}

/* Body text & links */
#content p{
  font-size: 1.05rem;
  line-height: 1.7;
  margin: 0 0 1.1rem;
  color: var(--ink);
}
#content a{
  color: var(--accent-3);
  font-weight: 700;
  text-decoration: none;
}
#content a:hover{ color: var(--accent); text-decoration: underline; }

/* Lede paragraph for the first section */
.lede{
  font-size: 1.12rem;
  line-height: 1.75;
  color: #2a342f;
  margin-bottom: 1rem;
}

/* Card-like sections */
.intro-section,
.about-site,
.about-howto {
  background: #fff9ee;
  border: 2px solid var(--line);
  border-radius: 12px;
  padding: 1.4rem 1.5rem;
  margin: 0 auto 1.2rem;
  box-shadow: 0 4px 0 rgba(0,0,0,.08);
}

/* Subtle accent bar at the top */
.intro-section::before,
.about-site::before,
.about-howto::before{
  content:"";
  display:block;
  height: 6px;
  width: 84px;
  border-radius: 999px;
  background: linear-gradient(90deg, var(--accent), #5fa561);
  margin-bottom: .8rem;
}

/* Lists inside cards */
#content ul{
  margin: .25rem 0 1rem 1.2rem;
  padding: 0;
}
#content li{ margin: .35rem 0; }

/* Links page cards (kept, but tuned for consistency) */
.links-intro{
  text-align:center;
  max-width:800px;
  margin:2rem auto 1.5rem;
  padding:0 1rem;
}
.links-intro h2{ color: var(--accent); font-size: 1.6rem; }
.links-intro p{ color: var(--ink); }

.links-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));
  gap:1.2rem;
  padding: 0 0 2.2rem;
  max-width:1000px;
  margin:0 auto;
}
.link-card{
  background:#fff9ee;
  border:2px solid var(--line);
  border-radius:12px;
  padding:1.1rem 1.25rem;
  box-shadow:0 4px 0 rgba(0,0,0,.08);
  transition:transform .15s ease, box-shadow .15s ease;
}
.link-card:hover{ transform:translateY(-3px); box-shadow:0 6px 10px rgba(0,0,0,.12) }
.link-card h3{
  font-family:"Archivo Black", system-ui;
  color:var(--accent);
  font-size:1.2rem;
  margin:.1rem 0 .3rem;
}
.link-card ul{ list-style:none; margin:.35rem 0 0; padding:0 }
.link-card li{ margin:.35rem 0 }
.link-card a{ text-decoration:none; color:var(--accent-3); font-weight:600 }
.link-card a:hover{ color:var(--accent); text-decoration:underline }

/* Footer for static pages */
.site-foot{
  border-top: 2px solid var(--line);
  background: #f6f1e4;
  text-align: center;
  padding: .9rem 1rem;
  color: #3b463f;
  font-size: .95rem;
}

/* Responsive tweaks */
@media (max-width: 760px){
  #content{ padding: 1.25rem 12px 2.25rem; }
  #content h1{ font-size: 1.55rem; }
  #content h2{ font-size: 1.25rem; }
  .intro-section, .about-site, .about-howto{ padding: 1.1rem 1.1rem; }
}


/* =========================
   Mobile adjustments
   ========================= */
@media (max-width: 760px){
  /* Smaller header */
  :root{ --hdr: 72px; }
  #site-header{ padding:.45rem .75rem; flex-wrap:wrap; row-gap:.35rem }
  .logo{ width:44px; height:44px }
  .brand{ flex:1 1 auto; min-width:220px }
  .brand-text .tag{ display:none }      /* hide tagline on mobile */
  .nav-links{ flex:0 0 auto; gap:.5rem }
  .nav-item{ padding:.3rem .55rem; font-size:.9rem }

  /* One-column layout; sidebar overlays map between header & footer */
  #layout{ grid-template-columns:1fr; height:calc(100dvh - var(--hdr)) }

  #sidebar{
    position:fixed; z-index:50;
    top:var(--hdr); left:0; right:0; bottom:var(--ftr);
    transform:translateY(-100%);
    transition:transform .25s ease;
    display:flex; flex-direction:column; overflow:hidden;
  }
  #sidebar.open{ transform:translateY(0) }
  .list{ overflow:auto }

  #map-wrap{ height:calc(100dvh - var(--hdr)) }
  .legend{ left:8px; bottom:8px }

  /* Filters stack neatly */
  .search-row{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:.5rem;
  }
  #search{ grid-column:1 / -1 }
  #filterType,#filterLocation,#filterActivity{ width:100%; max-width:none }

  /* Drawer mobile comfort */
  .drawer {
    right: 8px; left: 8px; width: auto; bottom: 8px; top: auto;
    max-height: 70vh;
  }
  .drawer-body { padding: .85rem; }
}

/* ===== Mobile-only filter bar ===== */
.filters-mobile {
  display: none; /* hidden on desktop */
}

@media (max-width: 760px){
  /* Show the mobile filter bar, hide the desktop sidebar/list. */
  .filters-mobile{
    display:block;
    position:sticky;
    top:var(--hdr, 72px);
    z-index:350;
    background:linear-gradient(180deg,#fff8ea,#f6f1e4);
    border-bottom:2px solid var(--line);
  }
  .filters-mobile .filters-inner{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:.5rem;
    padding:.6rem .75rem;
  }
  #mSearch{ grid-column:1 / -1 }

  /* Reuse the same input look */
  #mSearch,
  #mFilterType,#mFilterLocation,#mFilterActivity{
    padding:.5rem .6rem; border:2px solid var(--ink); border-radius:.4rem; background:#fff;
    min-width:0; font-size:1rem; line-height:1.2;
  }

  /* One-column layout, hide the desktop sidebar entirely */
  #layout{ grid-template-columns: 1fr; height: calc(100dvh - var(--hdr,72px) - var(--mobf, 64px)); }
  #sidebar{ display:none; }

  /* Map fills the rest, legend stays pinned */
  #map-wrap{ height: 100%; }
  .legend{ left:8px; bottom:8px }
}

/* =========================
   Shared utility elements (new)
   ========================= */

/* Skip link for keyboard navigation */
.skip-link {
  position: absolute;
  left: -999px;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
}
.skip-link:focus {
  left: 0;
  top: 0;
  width: auto;
  height: auto;
  padding: .5rem 1rem;
  background: var(--accent);
  color: #fff;
  font-weight: 700;
  border-radius: 0 0 .5rem .5rem;
  z-index: 999;
}

/* Guide list (About page "How to Use the Map") */
.guide-list {
  list-style: disc;
  padding-left: 1.5rem;
  margin: .5rem 0 1rem;
}
.guide-list li { margin-bottom: .4rem; line-height: 1.6; }

/* Back-to-map variant (optional) */
.btn { display:inline-flex; align-items:center; justify-content:center; }
.btn.back-map {
  margin-top: 1rem;
  background: var(--accent);
  color: #fff;
  border: 2px solid var(--ink);
}
.btn.back-map:hover {
  background: var(--accent-2);
  color: var(--ink);
}

/* Cards grid list (Links page UL wrapper) */
.cards--grid {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
}
.cards--grid .link-card { margin: 0; }


/* make sure the map's stacking level is lower than overlays we add */
#map { z-index: 0; }

/* put the info button above Leaflet panes/controls */
.map-info { z-index: 1200; }
/* Legend styling inside the modal (not the floating card) */
.legend-embed .legend-title{
  font-family:"Archivo Black", system-ui;
  font-size:1rem;
  margin: .2rem 0 .45rem;
  color: var(--ink);
}
.legend-embed .legend-list{
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:.2rem;
}
.legend-embed .legend-row{
  display:flex;
  align-items:center;
  gap:.55rem;
  padding:.22rem .35rem;
  border-radius:8px;
}
.legend-embed .legend-row:hover,
.legend-embed .legend-row:focus-within{ background:#fff3d4; }
.legend-embed .legend-row img{ width:20px; height:20px; display:block; }
.legend-embed .legend-line{ display:inline-block; width:18px; height:3px; background:#2f7c31; border-radius:2px; }

/* Drawer description: tidy paragraphs/line breaks */
.drawer .desc p { margin: 0 0 1em; line-height: 1.6; }
.drawer .desc br { line-height: 1.2; }

/* Drawer activity chips: single line + '+N more' */
.drawer .acts{
  display:flex; align-items:center; gap:.35rem;
  margin:.25rem 0 .5rem;
  flex-wrap:nowrap; overflow:hidden;
}
.drawer .acts .chip{
  display:inline-flex; align-items:center; white-space:nowrap;
  padding:.18rem .5rem; border:1.5px solid var(--line);
  border-radius:999px; background:#fff;
  font-size:.85rem; line-height:1; color:var(--ink); font-weight:600;
}
.drawer .acts .more{
  border:1.5px solid var(--ink); background:#f5f0df; font-weight:700;
}

/* 'More like this' pills (no bullets) */
.morelike-wrap{ margin-top: .8rem; }
.morelike{
  display:flex; flex-wrap:wrap; gap:.35rem; padding:0; margin:.35rem 0 0;
}
.morelike .tag{
  display:inline-flex; align-items:center; white-space:nowrap;
  padding:.2rem .55rem; border:1.5px solid var(--line);
  border-radius:999px; background:#fff;
  font-size:.9rem; line-height:1.1; color:var(--ink);
}
.morelike .tag:hover{ background:#fff3d4; }

/* Trail popup uses the same visual system as other popups */
.popup-desc p{ margin: 0 0 1em; line-height: 1.55; }

/* Make popups comfortable on phones: not full-screen; content scrolls */
@media (max-width: 760px){
  .leaflet-popup-content-wrapper{
    max-width: 320px;          /* align with JS maxWidth */
  }
  .leaflet-popup-content{
    max-height: 55vh;          /* avoid covering the whole screen */
    overflow: auto;            /* scroll inside the popup if long */
  }
  /* Bigger close button for touch */
  .leaflet-popup-close-button{
    width: 28px; height: 28px; line-height: 28px; font-size: 20px;
  }
}
